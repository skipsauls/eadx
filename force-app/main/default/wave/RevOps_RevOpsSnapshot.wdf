["{\"nodes\":{\"Edgemart_Opportunity\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"eadx__opportunity10\"}},\"Compute_RemoveDataFlag_Opportunity\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"RemoveDataFlag\",\"name\":\"RemoveDataFlag\",\"saqlExpression\":\"case when 'SnapshotTextDate' == date_to_string(now(),\\\"yyyy-MM-dd\\\") || 'SnapshotTextDate' == \\\"1900-01-01\\\" then \\\"true\\\" else \\\"false\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Edgemart_Snapshot_Opportunity\"]},\"Filter_Source_Data_Opportunity\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"CustomSnapshotFilter:EQ:true\"},\"sources\":[\"Compute_Additional_Flags_Opportunity\"]},\"Filter_Snapshot_Data_Opportunity\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"SnapshotFilter:EQ:true\"},\"sources\":[\"Compute_Snapshot_Filter_Opportunity\"]},\"Compute_Additional_Flags_Opportunity\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Snapshot Text Date\",\"name\":\"SnapshotTextDate\",\"saqlExpression\":\"toString(toDate('SnapshotDate_sec_epoch'),\\\"yyyy-MM-dd\\\")\",\"type\":\"Text\"},{\"label\":\"CustomSnapshotFilter\",\"name\":\"CustomSnapshotFilter\",\"saqlExpression\":\"\\\"true\\\"\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_SnapshotDate_Opportunity\"]},\"Register_Opportunity_Snapshot\":{\"action\":\"register\",\"parameters\":{\"label\":\"Opportunity Snapshot\",\"name\":\"eadx__opportunity_snapshot\"},\"sources\":[\"Slice_Flag_Fields_Opportunity\"]},\"Slice_Flag_Fields_Opportunity\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"RemoveDataFlag\"},{\"name\":\"SnapshotFilter\"}],\"mode\":\"drop\"},\"sources\":[\"Filter_Snapshot_Data_Opportunity\"]},\"Compute_SnapshotDate_Opportunity\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"Snapshot Date\",\"name\":\"SnapshotDate\",\"saqlExpression\":\"toDate(date_to_string(now(),\\\"yyyy-MM-dd\\\"),\\\"yyyy-MM-dd\\\")\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"Edgemart_Opportunity\"]},\"Edgemart_Snapshot_Opportunity\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"eadx__opportunity_snapshot\"}},\"Append_Latest_Snapshot_Opportunity\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"Filter_Source_Data_Opportunity\",\"Filter_Duplicate_Snapshot_Dates_Opportunity\"]},\"Compute_Snapshot_Filter_Opportunity\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"SnapshotFilter\",\"name\":\"SnapshotFilter\",\"saqlExpression\":\"case when date_diff(\\\"day\\\", toDate(SnapshotDate_sec_epoch), now()) > 732 then \\\"false\\\" else \\\"true\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Append_Latest_Snapshot_Opportunity\"]},\"Filter_Duplicate_Snapshot_Dates_Opportunity\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"RemoveDataFlag:EQ:false\"},\"sources\":[\"Compute_RemoveDataFlag_Opportunity\"]}}}",null]